{% extends "dashboard/admin/base.html" %}

{% block page_title %}{{ patient.get_full_name }} - Patient Details{% endblock %}

{% block admin_content %}
<div class="row">
  <div class="col-md-8">
    <div class="card">
      <div class="card-header d-flex justify-content-between align-items-center">
        <div>
          <h2 style="margin:0;">{{ patient.get_full_name }}</h2>
          <small class="text-muted">Patient Details</small>
        </div>
        <div class="btn-group">
          <a href="{% url 'patients:update' patient.patient_id %}" class="btn btn-outline-primary">
            <i class="fas fa-edit me-2"></i>Edit
          </a>
          <a href="{% url 'patients:dashboard' patient.patient_id %}" class="btn btn-outline-info">
            <i class="fas fa-chart-line me-2"></i>Dashboard
          </a>
          <a href="{% url 'patients:list' %}" class="btn btn-outline-secondary">
            <i class="fas fa-arrow-left me-2"></i>Back to List
          </a>
        </div>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <h5 class="text-muted mb-3">Personal Information</h5>
            <table class="table table-sm">
              <tr>
                <td><strong>Patient ID:</strong></td>
                <td><span class="badge bg-primary">{{ patient.patient_id }}</span></td>
              </tr>
              <tr>
                <td><strong>Full Name:</strong></td>
                <td>{{ patient.get_full_name }}</td>
              </tr>
              <tr>
                <td><strong>Date of Birth:</strong></td>
                <td>{{ patient.date_of_birth|date:"F j, Y" }}</td>
              </tr>
              <tr>
                <td><strong>Age:</strong></td>
                <td>{{ patient.age }} years</td>
              </tr>
              <tr>
                <td><strong>Gender:</strong></td>
                <td>{{ patient.get_gender_display }}</td>
              </tr>
            </table>
          </div>
          
          <div class="col-md-6">
            <h5 class="text-muted mb-3">Contact Information</h5>
            <table class="table table-sm">
              <tr>
                <td><strong>Phone:</strong></td>
                <td>{{ patient.phone_number|default:"Not provided" }}</td>
              </tr>
              <tr>
                <td><strong>Email:</strong></td>
                <td>{{ patient.email|default:"Not provided" }}</td>
              </tr>
              <tr>
                <td><strong>Address:</strong></td>
                <td>{{ patient.address|default:"Not provided" }}</td>
              </tr>
              <tr>
                <td><strong>City:</strong></td>
                <td>{{ patient.city|default:"Not provided" }}</td>
              </tr>
              <tr>
                <td><strong>State:</strong></td>
                <td>{{ patient.state|default:"Not provided" }}</td>
              </tr>
            </table>
          </div>
        </div>
        
        <div class="row mt-4">
          <div class="col-md-6">
            <h5 class="text-muted mb-3">Emergency Contact</h5>
            <table class="table table-sm">
              <tr>
                <td><strong>Contact Name:</strong></td>
                <td>{{ patient.emergency_contact_name|default:"Not provided" }}</td>
              </tr>
              <tr>
                <td><strong>Contact Phone:</strong></td>
                <td>{{ patient.emergency_contact_phone|default:"Not provided" }}</td>
              </tr>
              <tr>
                <td><strong>Relationship:</strong></td>
                <td>{{ patient.emergency_contact_relation|default:"Not provided" }}</td>
              </tr>
            </table>
          </div>
          
          <div class="col-md-6">
            <h5 class="text-muted mb-3">System Information</h5>
            <table class="table table-sm">
              <tr>
                <td><strong>Created:</strong></td>
                <td>{{ patient.created_at|date:"F j, Y, g:i A" }}</td>
              </tr>
              <tr>
                <td><strong>Last Updated:</strong></td>
                <td>{{ patient.updated_at|timesince }} ago</td>
              </tr>
              <tr>
                <td><strong>Created By:</strong></td>
                <td>{{ patient.created_by.get_full_name|default:patient.created_by.username|default:"System" }}</td>
              </tr>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-md-4">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">Quick Actions</h5>
      </div>
      <div class="card-body">
        <div class="d-grid gap-2">
          <a href="{% url 'patients:update' patient.patient_id %}" class="btn btn-primary">
            <i class="fas fa-edit me-2"></i>Edit Patient
          </a>
          <a href="{% url 'patients:dashboard' patient.patient_id %}" class="btn btn-info">
            <i class="fas fa-chart-line me-2"></i>View Dashboard
          </a>
          <a href="{% url 'questionnaires:response_list' %}?patient={{ patient.patient_id }}" class="btn btn-success">
            <i class="fas fa-clipboard-list me-2"></i>View Questionnaires
          </a>
          <hr>
          <a href="{% url 'patients:delete' patient.patient_id %}" class="btn btn-outline-danger">
            <i class="fas fa-trash me-2"></i>Delete Patient
          </a>
        </div>
      </div>
    </div>
    
    <div class="card mt-3">
      <div class="card-header">
        <h5 class="mb-0">Statistics</h5>
      </div>
      <div class="card-body">
        <div class="text-center">
          <div class="mb-3">
            <h4 class="text-primary">{{ patient.questionnaire_responses.count }}</h4>
            <small class="text-muted">Questionnaire Responses</small>
          </div>
          <div class="mb-3">
            <h4 class="text-info">{{ patient.age }}</h4>
            <small class="text-muted">Years Old</small>
          </div>
          <div>
            <h4 class="text-success">{{ patient.get_gender_display }}</h4>
            <small class="text-muted">Gender</small>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
